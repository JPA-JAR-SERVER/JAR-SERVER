<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>회원정보 수정</title>
    <link rel="stylesheet" href="/css/common.css">
    <link rel="stylesheet" href="/css/mypage/modify.css">
    <link rel="icon" href="/image/logo/favicon.png">
    <link rel="stylesheet" href="/css/mypage/alert.css">
    <link rel="stylesheet" href="/css/mypage/side-menu.css">
    <link rel="stylesheet" href="/css/mypage/user-header.css">
    <link rel="stylesheet" href="/css/mypage/header.css">
    <link rel="stylesheet" href="/css/mypage/footer.css">
</head>

<body>
    <div class="mypage-wrap">
        <div id="header" th:insert="~{mypage/header :: header}"></div>
        <div class="modify-wrap">
            <div class="image-modify-box">
                <label class="image-modify-layout">
                    <input type="file" name="file" style="display:none;">
                    <div class="image-profile-box">
                        <div class="image-size">
                            <span class="image-span">
                                <picture class="image-picture">

                                </picture>
                            </span>
                        </div>
                        <div class="image-pen">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none"
                                viewBox="0 0 24 24">
                                <path fill-rule="evenodd"
                                    d="M4 21a1 1 0 01-1-1v-4a1 1 0 01.293-.707l11-11a3.83 3.83 0 015.414 0 3.83 3.83 0 010 5.414l-11 11A1 1 0 018 21H4zm1-2h2.586l.707-.707-2.586-2.586-.707.707V19z"
                                    fill="#FFF"></path>
                            </svg>
                        </div>
                    </div>
                </label>
            </div>
            <form th:action="@{/mypage/modify-member/}" name="form" method="post">
                <div class="form-layout">
                    <div class="form-box">
                        <label class="form-title">이름</label>
                        <div>
                            <input type="text" class="modify-input" name="memberName" placeholder="본인 이름 넣기" th:value="${memberDTO.memberName}">
                        </div>
                        <p class="error-msg name-error"></p>
                    </div>
                </div>
                <div class="form-layout">
                    <div class="form-box">
                        <label class="form-title">닉네임</label>
                        <div>
                            <input type="text" class="modify-input" name="memberNickname" placeholder="본인 닉네임 넣기"th:value="${memberDTO.memberNickname}">
                        </div>
                        <p class="error-msg nick-name-error"></p>
                    </div>
                </div>
                <div class="form-layout">
                    <div class="form-box">
                        <label class="form-title">휴대폰 번호</label>
                        <div class="flex">
                            <div style="flex-grow: 1;">
                                <input type="text" class="modify-input phone_number" placeholder="-을 제외한 휴대폰 번호를 입력해주세요." th:value="${memberDTO.memberPhoneNumber}" disabled>
                            </div>
                            <button type="button"
                                class="common-button change-phone-button phone-modify-button phone-number-modify-button">
                                수정
                            </button>
                        </div>
                    </div>
                </div>
                <div class="form-layout">
                    <hr>
                    <label class="message-accept" style="margin-bottom: 20px;">
                        <span class="message-span">
                            <span>이벤트 정보 수신 동의</span>
                        </span>
                        <input type="checkbox" class="accept" style="display:none;">
                        <div class="toggle-box"></div>
                    </label>
                    <hr>
                </div>
                <div class="form-layout">
                    <button type="button" class="common-button modify-submit-button modify-accept modify-button">
                        <span class="auto-flex">수정하기</span>
                    </button>
                </div>
            </form>
            <button class="common-button withdraw-button withdraw-open">
                <span class="auto-flex">회원탈퇴</span>
            </button>
        </div>
        <div class="none-cell"></div>
        <div id="footer" th:insert="~{mypage/footer :: footer}"></div>
    </div>

    <!-- 휴대폰 번호 모달 -->
    <div class="phone-modal-display">
        <div class="phone-number-modal">
            <div class="phone-modal-box">
                <div class="phone-modal-title-box">
                    <h3 class="phone-modal-title">휴대폰 인증하기</h3>
                    <button class="common-button modal-exit exit">
                        <span class="auto-flex">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none"
                                viewBox="0 0 24 24">
                                <path
                                    d="M18.5 4L12 10.5 5.5 4 4 5.5l6.5 6.5L4 18.5 5.5 20l6.5-6.5 6.5 6.5 1.5-1.5-6.5-6.5L20 5.5 18.5 4z"
                                    fill="#1a1a1a"></path>
                            </svg>
                        </span>
                    </button>
                </div>
                <div class="phone-modal-sub-title">정보 수정을 위해 본인의 휴대폰 번호를 인증해 주세요.</div>
                <div class="phone-modal-input-box">
                    <div class="phone-modal-input-box-layout">
                        <label class="form-title">휴대폰 번호</label>
                        <div class="flex-row">
                            <div class="phone-input-box">
                                <div style="flex-grow: 1;">
                                    <input class="modify-input" type="text" placeholder="-을 제외한 휴대폰 번호를 입력해주세요."
                                        name="phoneNumber">
                                </div>
                                <button type="button"
                                    class="common-button change-phone-button phone-modify-button send-auth-button"
                                    disabled>
                                    <span class="auto-flex">인증 번호 받기</span>
                                </button>
                            </div>
                        </div>
                        <p class="error-msg phone-number-error"></p>
                    </div>
                    <div class="flex-row auth-box">
                        <div class="phone-input-box">
                            <div style="flex-grow: 1;">
                                <input class="modify-input" type="text" name="code" placeholder="문자메시지로 받은 번호를 입력해주세요.">
                            </div>
                            <button type="button"
                                class="common-button phone-number-confirm-button phone-modify-button auth-check-button"
                                disabled>
                                <span class="auto-flex">확인</span>
                            </button>
                        </div>
                    </div>
                    <p class="auth-msg"></p>
                </div>
                <div class="phone-modal-button-box">
                    <button type="button" class="common-button change-phone-button cancel-button exit">
                        <span class="auto-flex">취소</span>
                    </button>
                    <button type="button" class="common-button phone-number-confirm-button phone-number-change-button"
                        disabled>
                        <span class="auto-flex">확인</span>
                    </button>
                </div>
            </div>
        </div>
    </div>


    <!-- 회원탈퇴 모달 -->
    <div class="withdraw-display">
        <div class="withdraw-modal">
            <div class="modal-back"></div>
            <div class="withdraw-modal-box">
                <h1 class="withdraw-main-title">
                    <div style="flex-grow: 1;">정말 JAR를 떠나실 건가요?</div>
                    <div class="exit-icon exit-withdraw">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24">
                            <path
                                d="M18.5 4L12 10.5 5.5 4 4 5.5l6.5 6.5L4 18.5 5.5 20l6.5-6.5 6.5 6.5 1.5-1.5-6.5-6.5L20 5.5 18.5 4z"
                                fill="#cacaca"></path>
                        </svg>
                    </div>
                </h1>
                    <div class="withdraw-sub-title">회원탈퇴 신청 전 아래 사항을 확인 부탁드립니다 😊</div>
                    <div class="withdraw-sub-content">1. 신청일부터 5일 후 회원탈퇴가 처리되며, 회원탈퇴 처리 전까지 고객센터에서 그 신청을 철회할 수 있습니다.
                    </div>
                    <div class="withdraw-sub-content">2. 회원탈퇴 후 기존 계정으로 회원가입을 신청할 수 없습니다.</div>
                    <div class="withdraw-sub-content">3. 회원탈퇴 시 회사가 보관하고 있는 회원 데이터는 모두 영구적으로 삭제됩니다. 다만, 관련 법령에 따라 회사가
                        보관할 의무가 있는 정보 또는 자료는 일정기간 동안 보관됩니다.</div>
                    <div class="withdraw-sub-content">4. 회원탈퇴 후 JAR에 게시한 게시물을 편집하거나 삭제할 수 없습니다. 필요한 경우 신청 전 게시물을
                        편집하거나 삭제해주세요.</div>
<!--                    <div style="margin-top:40px;">-->
<!--                        <h4 class="withdraw-reson-title">떠나시기 전에</h4>-->
<!--                        <div class="withdraw-reson-sub-title">이유를 알려주세요</div>-->
<!--                        <div>-->
<!--                            <textarea class="reson-textarea"-->
<!--                                placeholder="탈퇴하시려는 이유를 알려주세요. 소중한 의견을 반영하여 더 나은 서비스를 만들도록 노력하겠습니다"></textarea>-->
<!--                        </div>-->
<!--                    </div>-->
                    <div style="margin-top: 63px;">
                        <div class="check-title">계정을 삭제하시겠어요?</div>
                        <button class="common-button withdraw-button exit-withdraw" type="button">
                            <span class="auto-flex">JAR 계속 사용하기</span>
                        </button>
                        <form th:action="@{/mypage/withdraw}" method="post">
                            <button class="common-button  modify-submit-button" style="margin-top: 10px;" type="submit">
                                <span class="auto-flex">계정 삭제하기</span>
                            </button>
                        </form>
                    </div>
            </div>
        </div>
    </div>

    <!-- 잠깐 나왓다 사라지는 알람창 -->
    <div class="alert-modal-display">
        <div class="diary-modal">
            <div class="alert-modal-box" style="width: 500px;">
                <div style="text-align: center;">
                    <div style="margin-top: 12px;">
                        <span class="alert"></span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
<script src="https://code.jquery.com/jquery-3.6.3.min.js"></script>
<script th:inline="javascript">
    let member = [[${session.member}]];
    let memberFile = [[${memberDTO.fileDTO}]];
    const memberDTO = [[${memberDTO}]];
    const fileDTO = memberDTO.fileDTO;
    let profile;
    let memberId;
    if (member) {
        memberId = member.id;
    }
    if(fileDTO != null ){
        profile = fileDTO;
    }
    profileImageCheck();
    function profileImageCheck(){
        let text = '';
        if(fileDTO == null){
            text = `
                    <img class="profile-image" src="/image/logo/normal_profile.png">
            `;
        }else {
            text = `
                   <img  class="profile-image" src="/file/display?fileName=${fileDTO.filePath}/${fileDTO.fileUuid}_${fileDTO.fileOriginalName}">
            `;
        }
        $(".image-picture").html(text);
    }

</script>
<script src="/js/mypage/profile.js"></script>
<script src="/js/mypage/modify.js"></script>
<script src="/js/main/header.js"></script>
</html>